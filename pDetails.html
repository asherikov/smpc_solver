<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>A sparse MPC solver for walking motion generation.: Minor implemetation details</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">A sparse MPC solver for walking motion generation.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Minor implemetation details </h1>  </div>
</div>
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="pDetNotes"></a>
Notes</h2>
<p>It is implicitly supposed that we have 6 state variables and 2 control variables.</p>
<h2><a class="anchor" id="pDetMatrices"></a>
Representation of matrices</h2>
<p>Note, that parts of state and control matrices (<a class="el" href="pProblemDef.html#pPDModel">Model of the system</a>) corresponding to x and y coordinates are identical. This property is preserved in all subsequent transformations, hence there is no need to compute and store all elements of static matrices (Cholesky factor for example). Consequently, we mainly operate on 3x3 matrices, which are stored in the following way: </p>
<div class="fragment"><pre class="fragment">
  0   3   6
  1   4   7
  2   5   8
</pre></div><h3><a class="anchor" id="pDetCholesky"></a>
Cholesky factor</h3>
<p>The Cholesky factor consists of two parts:</p>
<ul>
<li>A constant and well structured 'upper' part, which corresponds to equality constraints: <div class="fragment"><pre class="fragment">
           full L                           |   compressed L
            a                               |
            0   a                           |           a
            b   0   c                   0   |           b   c
            0   b   0   c                   |   ===&gt;        d   e
                    d   0   e               |   ===&gt;            f   g
                    0   d   0   e           |                       ...
                0           f   0   g       |
                            0   f   0   g   |
                                    ....    |
</pre></div> Here a,c,e,g - lower diagonal 3x3 matrices; b,d,f - upper triangular 3x3 matrices. This matrix is reffered as ecL. It is stored as a sequence of vectors of 9 elements: <div class="fragment"><pre class="fragment">
        0  3  6 
        1  4  7
        2  5  8

        9  12 15  18 21 24
        10 13 16  19 22 25
        11 14 17  20 23 26

                    ...         ...
</pre></div></li>
</ul>
<ul>
<li>A less structured part corresponding to inequality constraints. It is altered each time the active set is changed. This part is stored as a set of 2*N vectors. The length of each vector could not be longer than N*<a class="el" href="group__gINTERNALS.html#gae8780c341d0ab405a8d820726f7e3b5c" title="Total number of variables.">NUM_VAR</a>. <br/>
<br/>
</li>
</ul>
<h2><a class="anchor" id="pBounds"></a>
Implementing bounds</h2>
<p>Consider the variable</p>
<p><img class="formulaInl" alt="$ \newcommand{\mbm}[1]{\mbox{\boldmath $#1$}}\\ \mbm{x} = \left[\begin{array}{c} x_1 \\ x_2 \\ x_3 \\ x_4 \\ x_5 \\ x_6 \end{array}\right]. $" src="form_91.png"/></p>
<p>Suppose that variables <img class="formulaInl" alt="$x_1$" src="form_92.png"/> and <img class="formulaInl" alt="$x_4$" src="form_93.png"/> have simple bounds (and the rest of the variables are are not subject to inequality constraints), i.e.,</p>
<p><img class="formulaInl" alt="$ \newcommand{\mbm}[1]{\mbox{\boldmath $#1$}}\\ lb_1 \leq x_1 \leq ub_1 \\ lb_2 \leq x_2 \leq ub_2 $" src="form_94.png"/></p>
<p>The above four inequality constraints can be written as</p>
<p><img class="formulaInl" alt="$ \newcommand{\mbm}[1]{\mbox{\boldmath $#1$}}\\ \mbm{a}_1^T\mbm{x} \leq ub_1 \\ \mbm{a}_1^T\mbm{x} \geq lb_1 \\ \mbm{a}_2^T\mbm{x} \leq ub_2 \\ \mbm{a}_2^T\mbm{x} \geq lb_1, $" src="form_95.png"/></p>
<p>where</p>
<p><img class="formulaInl" alt="$ \newcommand{\mbm}[1]{\mbox{\boldmath $#1$}}\\ \mbm{a}_1^T = \left[\begin{array}{cccccc} 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \end{array}\right] \\ \mbm{a}_2^T = \left[\begin{array}{cccccc} 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \end{array}\right]. $" src="form_96.png"/></p>
<p>Note that both <img class="formulaInl" alt="$\newcommand{\mbm}[1]{\mbox{\boldmath $#1$}} \mbm{a}_1^T\mbm{x} \leq ub_1$" src="form_97.png"/> and <img class="formulaInl" alt="$\newcommand{\mbm}[1]{\mbox{\boldmath $#1$}} \mbm{a}_1^T\mbm{x} \geq lb_1$" src="form_98.png"/> can not be in the working set at the same time (because if we are on one of the bounds we can not be on the other one).</p>
<dl class="attention"><dt><b>Attention:</b></dt><dd>Note, that if we do not distinguish lower and upper bounds, Lagrange multipliers can be negative. </dd></dl>
</div></div>
<hr class="footer"/><address class="footer"><small>Generated by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
